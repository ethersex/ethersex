mainmenu_option next_comment
	comment "Periodic / Scheduler"

	int_min_max_step 'Periodic ticks per second' CONF_MTICKS_PER_SEC 50 50 20000 50
	MCU_HAS_TIMER_3_SUPPORT=$(mcu_has_timer_3_support)
	dep_bool "Periodic use Timer/Counter 3" PERIODIC_TIMER3_SUPPORT $MCU_HAS_TIMER_3_SUPPORT
	if [ "$PERIODIC_TIMER3_SUPPORT" = y ]; then
		define_symbol CONF_PERIODIC_USE_TIMER 3
	else
		define_symbol CONF_PERIODIC_USE_TIMER 1
	fi
	bool "Periodic timer API support" PERIODIC_TIMER_API_SUPPORT
	bool "Periodic adjust support" PERIODIC_ADJUST_SUPPORT

	dep_bool_menu "Periodic general debugging" DEBUG_PERIODIC $DEBUG
		dep_bool "Read periodic debug stats via ECMD" DEBUG_PERIODIC_ECMD_SUPPORT $DEBUG_PERIODIC $ECMD_PARSER_SUPPORT
		dep_bool "Toggle pins in periodic tick" DEBUG_PERIODIC_WAVEFORMS_SUPPORT $DEBUG_PERIODIC
		if [ "$PERIODIC_TIMER3_SUPPORT" = y ]; then
			dep_bool "Enable toggling of Timer/Counter OC1A-Pin" DEBUG_PERIODIC_OC1A_SUPPORT n
		else
			dep_bool "Enable toggling of Timer/Counter OC1A-Pin" DEBUG_PERIODIC_OC1A_SUPPORT $DEBUG_PERIODIC_WAVEFORMS_SUPPORT $DEBUG_PERIODIC
		fi
	endmenu
endmenu

dep_bool_menu "Status LEDs" STATUSLEDS $ARCH_AVR
	dep_bool "Status LED (Power)"		STATUSLED_POWER_SUPPORT		$STATUSLEDS
	dep_bool "Status LED (Booted)"		STATUSLED_BOOTED_SUPPORT	$STATUSLEDS
	dep_bool "Status LED (Net link)"	STATUSLED_NETLINK_SUPPORT	$STATUSLEDS
	dep_bool "Status LED (Transmitted)"	STATUSLED_TX_SUPPORT		$STATUSLEDS
	dep_bool "   RFM12 TX"			STATUSLED_RFM12_TX_SUPPORT	$STATUSLED_TX_SUPPORT $RFM12_SUPPORT
	dep_bool "   ZBUS TX"			STATUSLED_ZBUS_TX_SUPPORT	$STATUSLED_TX_SUPPORT $ZBUS_SUPPORT
	dep_bool "   IRMP TX"			STATUSLED_IRMP_TX_SUPPORT	$STATUSLED_TX_SUPPORT $IRMP_TX_SUPPORT
	dep_bool "   EMS TX"			STATUSLED_EMS_TX_SUPPORT	$STATUSLED_TX_SUPPORT $EMS_SUPPORT
	dep_bool "Status LED (Received)"	STATUSLED_RX_SUPPORT		$STATUSLEDS
	dep_bool "   RFM12 RX"			STATUSLED_RFM12_RX_SUPPORT	$STATUSLED_RX_SUPPORT $RFM12_SUPPORT
	dep_bool "   ZBUS RX"			STATUSLED_ZBUS_RX_SUPPORT	$STATUSLED_RX_SUPPORT $ZBUS_SUPPORT
	dep_bool "   IRMP RX"			STATUSLED_IRMP_RX_SUPPORT	$STATUSLED_RX_SUPPORT $IRMP_RX_SUPPORT
	dep_bool "   EMS RX OK"			STATUSLED_EMS_RX_OK_SUPPORT	$STATUSLED_RX_SUPPORT $EMS_SUPPORT
	dep_bool "Status LED (Error)"		STATUSLED_ERROR_SUPPORT		$STATUSLEDS
	dep_bool "   EMS RX Failure"		STATUSLED_EMS_RX_FAIL_SUPPORT	$STATUSLED_ERROR_SUPPORT $EMS_SUPPORT
	dep_bool "Heartbeat / Activity LED"	STATUSLED_HB_ACT_SUPPORT	$STATUSLEDS
	dep_bool "   Heartbeat"			STATUSLED_HEARTBEAT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT
	dep_bool "   RFM12 TX Activity"		STATUSLED_RFM12_TX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $RFM12_SUPPORT
	dep_bool "   RFM12 RX Activity"		STATUSLED_RFM12_RX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $RFM12_SUPPORT
	dep_bool "   ZBUS TX Activity"		STATUSLED_ZBUS_TX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $ZBUS_SUPPORT
	dep_bool "   ZBUS RX Activity"		STATUSLED_ZBUS_RX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $ZBUS_SUPPORT
	dep_bool "   EMS TX Activity"		STATUSLED_EMS_TX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $EMS_SUPPORT
	dep_bool "   EMS RX Activity"		STATUSLED_EMS_RX_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $EMS_SUPPORT
	dep_bool "   ECMD Activity"		STATUSLED_ECMD_ACT_SUPPORT	$STATUSLED_HB_ACT_SUPPORT $ECMD_SUPPORT
endmenu

if [ "$STATUSLED_HEARTBEAT_SUPPORT" = "y" ]; then
	if [ "$BOOTLOADER_SUPPORT" = "y" ]; then
		define_bool STATUSLED_HEARTBEAT_BOOTLOADER_SUPPORT y
	else
		define_bool STATUSLED_HEARTBEAT_STANDARD_SUPPORT y
	fi
fi
